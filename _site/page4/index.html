<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  ﻿<head>
    <link href="http://gmpg.org/xfn/11" rel="profile">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <!-- Enable responsiveness on mobile devices-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <title>
        
        Amr &middot; 
        
    </title>
    <!-- CSS -->
    <link rel="stylesheet" href="/public/css/poole.css">
    <link rel="stylesheet" href="/public/css/syntax.css">
    <link rel="stylesheet" href="/public/css/hyde.css">
    <link rel="stylesheet" href="/public/css/rjow.css">
    <link rel="stylesheet" href="/public/css/amr.css">
    <link rel="stylesheet" href="/public/css/gist.css">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
    <!-- Icons -->
    <link rel="shortcut icon" href="/public/images/favicon.ico">
    <!-- For Chrome for Android: -->
    <link rel="icon" sizes="192x192" href="/public/images/AmrAvatar192.png">
    <!-- For iPhone 6 Plus with @3× display: -->
    <link rel="apple-touch-icon-precomposed" sizes="180x180" href="/public/images/AmrAvatar180.png">
    <!-- For iPad with @2× display running iOS ≥ 7: -->
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/public/images/AmrAvatar152.png">
    <!-- For iPad with @2× display running iOS ≤ 6: -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/images/AmrAvatar144.png">
    <!-- For iPhone with @2× display running iOS ≥ 7: -->
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/public/images/AmrAvatar120.png">
    <!-- For iPhone with @2× display running iOS ≤ 6: -->
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/public/images/AmrAvatar114.png">
    <!-- For the iPad mini and the first- and second-generation iPad (@1× display) on iOS ≥ 7: -->
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/public/images/AmrAvatar76.png">
    <!-- For the iPad mini and the first- and second-generation iPad (@1× display) on iOS ≤ 6: -->
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/public/images/AmrAvatar72.png">
    <!-- For non-Retina iPhone, iPod Touch, and Android 2.1+ devices: 57×57px -->
    <link rel="apple-touch-icon-precomposed" href="/public/images/AmrAvatar57.png">
    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="theme-jekyll">

    <div class="sidebar">
    <div class="container sidebar-sticky">
        <div class="sidebar-about">
            <div class="flip-container" ontouchstart="this.classList.toggle('hover');">
                <div class="flipper">
                    <div class="front">
                        <div><img class="profilePic" src="/public/images/AmrAvatar.png" /></div>
                    </div>
                    <div class="back">
                        <div><img class="profilePic" src="/public/images/Amr.png" /></div>
                    </div>
                </div>
            </div>
            <br/>
            <small><i>Hi, My name is</i></small>
            <h1>
                <a class="blogTitle" href="/">
                    Amr
                </a>
            </h1>
            <small><i>and this is my</i></small>
            <p class="lead">Blog and personal website
</p>
        </div>
        <nav class="sidebar-nav">
            <a class="sidebar-nav-item" href="/">Home</a>
            

            
            
                
                    
                
            
                
                    
                    <a class="sidebar-nav-item" href="/about.html">About</a>
                    
                
            
                
            
                
            
                
                    
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            

            <br/>

            <a class="sidebar-nav-item side-nav-icon" 
               href="https://twitter.com/AmrEldib">
                <img class="side-nav-icon"
                     src="/public/images/twitter-24.png"
                     alt="@AmrEldib" />
            </a>
            <a class="sidebar-nav-item side-nav-icon" 
               href="https://github.com/AmrEldib">
                <img class="side-nav-icon"
                     src="/public/images/github-24.png"
                     alt="GitHub Page" />
            </a>
            <a class="sidebar-nav-item side-nav-icon" 
               href="http://www.goodreads.com/AmrEldib">
                <img class="side-nav-icon"
                     src="/public/images/goodreads-24.png"
                     alt="Goodreads Shelf" />
            </a>
            <a class="sidebar-nav-item side-nav-icon"
               href="https://www.linkedin.com/in/AmrEldib">
                <img class="side-nav-icon"
                     src="/public/images/linked-24.png"
                     alt="LinkedIn Resume" />
            </a>
            <a class="sidebar-nav-item side-nav-icon" 
               href="http://feeds.feedburner.com/AmrEldib">
                <img class="side-nav-icon"
                     src="/public/images/rss-24.png"
                     alt="Subscribe via RSS" />
            </a>
        </nav>
        <p><small>&copy; 2014. All rights reserved.</small></p>
    </div>
</div>


    <div class="content container">
      <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/AppStoreForTheRestOfUs">
        An App Store for the Rest of Us
      </a>
    </h1>

    <span class="post-date">13 Jan 2012</span>

    <p>I’ve blogged a year ago about App Stores, calling that <a href="http://www.amreldib.com/2011/01/everybody-gets-app-store.html">everybody gets an App Store</a> or as Scott Hanselman <a href="https://twitter.com/#!/shanselman/status/144635686966919168">tweeted</a> it “There’s an App Store for that!”. I had hope for Microsoft to build a better app store that isn’t like Apple’s. So much for my hopes that were crushed when the details of Windows 8’s store was <a href="http://www.zdnet.com/blog/microsoft/microsoft-previews-windows-8-app-store-launching-with-the-beta-in-late-february/11340">revealed last month</a>. Microsoft <a href="http://www.winrumors.com/microsoft-promises-developers-a-bigger-bite-of-the-apple-with-its-windows-8-app-store/">promised developers a bigger bite</a> of the apple, bigger than Apple’s. 80% rather than 70%. Your app qualify for the bigger cut if your sales exceed 25,000$.</p>

<p>While that seems generous, I still didn’t like the phrase Microsoft used to describe taking a percentage of your revenue; “Revenue Sharing”.
&lt;div align="justify"&gt; &lt;div style="padding-bottom: 0px; margin: 0px auto; padding-left: 0px; width: 623px; padding-right: 0px; display: block; float: none; padding-top: 0px" id="scid:5737277B-5D6D-4f48-ABFC-DD9C333F4C5D:a0997665-3d1e-40ef-ac3e-e5574cd887ef" class="wlWriterEditableSmartContent"&gt;&lt;div id="a7655fa1-691c-4e33-b6e9-540772e0f140" style="margin: 0px; padding: 0px; display: inline;"&gt;&lt;div&gt;<a href="http://www.youtube.com/watch?v=37E3jQIs2AA"><img src="http://lh5.ggpht.com/-yvOzARttfrI/TxCLQ3_VhEI/AAAAAAAAALk/3zCAwJ3s1Ec/video78b17b10187d%25255B15%25255D.jpg?imgmax=800" alt="" /></a>&lt;/div&gt;&lt;/div&gt;&lt;div style="width:623px;clear:both;font-size:.8em"&gt;Microsoft previews the Windows Store&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</p>

<p>Imagine the government re-labeling taxes as “Revenue Sharing”.</p>

<p>So, Microsoft creates a platform (if we can pass upgrading Windows as creating a new platform), announces that the only way you can get applications of that platform is through their app store and then takes away a percentage out of every single copy sold on that platform.</p>

<p>Imagine you’re a tiny shop building applications for Windows. Now, you want to switch your app that costs 10$ to the new Metro-style UI of Windows 8. How are you going to handle pricing? Are you giving up 3$ to Microsoft and reducing your income by 30% or are you going to raise your price to make room for the new cost and piss off your customers who have seen price increase with no features to justify it which eventually will lead (at least some) customers to jump ship to other products.</p>

<p>Why is a 30% (or even 20%) cut out of every copy sold on Windows Store justified? Is Microsoft not making enough money from every single copy of Windows running on 90% of computers on the planet? Do they really need to have 30% share of the entire software revenue on top of Windows revenue.</p>

<p>What exactly justifies taking a 30% cut? Hosting the application, distributing updates, reviews capabilities, all these doesn’t justify taking a percentage of revenue. No, it’s the monopoly. “You wanna build an app for this platform, then we’ll share revenue”. It’s all part of the Apple-ification of Microsoft. Redmond has been lifting pages out of Apple’s playbook, but this time they’ve gone too far.</p>

<p>Apple has always used monopoly over its platform as a revenue generator. “Use our hardware”, “Use our software”, developers build little tools to add functionality to MacOS only to find Apple copy their ideas in the next release of the operating system and claim credit for it. Microsoft has always been unlike that. They celebrate partnership with other hardware and software vendors. They open up the chance for developers to build tools to cover up for Windows shortcomings. “Live and let live”. Not any more, it seems.</p>

<p>It’s also the “consumerization”. Putting the consumer first. Let business, power users and tech people take a back seat for a bit. The average Joe is the center of attention. He doesn’t want better software or more control, doesn’t care about customization, just make it easier and more shiny even with fewer functionality. Maybe it’s just me, but consumerization ruins general-purpose computation and PCs as we know it today. Consumerization turns PCs and Computers into appliances. One for each function. They deprive me from the ability to create and turn me into a consumer to whatever big companies give me.</p>

<p>I understand that this a lot to blame on an app store but it’s not the new functionality that bothers me. It’s the mentality with which it’s offered. An app store for Windows is a great feature that helps developers offer and distribute their applications. It’s been long over due. But Microsoft is taking the wrong approach to deliver this feature. If I were to build an app store for Windows, I would do the following:</p>

<ul>
  <li>
    <div align="justify">**Make it a new way to get applications, not the only way**: Users should choose to use an app store because it’s better not because it’s the only way. At least a billion PC user in the world, I’m not gonna claim what’s best for them.</div>
    <li> <div align="justify">**Developers can host their own apps**: If you’re a developer and want to host your own app, that’s fine. An app store is only an entry point to discover all the different app repositories offered by all developers.</div> <li> <div align="justify">**Recommendations not Control**: I believe that it’s important to guide average users to what’s best for them. “You shouldn’t use this applications because it’s buggy”. But not do that by anointing yourself King of the world. When a user purchase an app from a developer, it’s an agreement between the two and the platform vendor has nothing to do with it. I know that this app is buggy but I still would like to use it, it’s performing a function that I really need right now, I don’t want for the developer to comply with your review process. As a platform vendor who cares about how your platform is performing and used, you can use recommendations. “Microsoft doesn’t recommend this app because of performance issues” or “because of privacy issues”, “Please read for more details”. Developers would get an explanation for the recommendation and be able to fix the problem. Microsoft gets to place its recommendation high in the list next to the application description. This recommendation would really affect user’s decision and wouldn’t be restrictive to users who know what they’re doing.</div> <li>
<div align="justify">**Standards, Standards, Standards**: For this app store to be really open, and for it offer place for innovation by other software vendors, it has to rely of standards. A standard to how to discover apps, how to install them, license them, and update them. Standards that describe how these different process interact with each other, how two processes implemented by two different vendors can still work together. Microsoft can start by offering this standard and other would join.</div>

It’s a shame really that Microsoft is taking over the software market like this. In times where there are attempts by governments to control the Internet, in more [ways](http://en.wikipedia.org/wiki/SOPA) than [one](http://www.usatoday.com/tech/news/internetprivacy/2011-02-15-kill-switch_N.htm). It doesn’t help that giant software companies are restricting computers as well.
</li></li></li>
  </li>
</ul>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/SyncWindowsLiveWriterPostsBetweenComputers">
        Sync Windows Live Writer Posts Between Computers
      </a>
    </h1>

    <span class="post-date">11 Jan 2012</span>

    <p><img src="https://public.sn2.livefilestore.com/y1pXz9ghSH071kCGDO68fx3YcX_s4r_Sa1Mgtl4A3-gYaCHW4rsiWuBfvBf3ebP9KNoMh1ByZWWaiukqRLpMf2b0Q/Windows_Live_Writer_logo.png?psid=1" alt="" />With all the different PCs between work and home, desktops and laptops, synchronization is becoming very important. I wanted to sync blog drafts between different computers which turned out to be very simple. Unfortunately, Windows Live doesn’t offer a solution out of the box, even though Windows Live Essentials comes with Live Mesh along with Live Writer. It’s a matter of putting two and two together which what I’ll do.</p>

<p>First, <a href="http://www.lehsys.com/2011/04/how-to-change-the-drafts-and-recent-posts-folder-in-windows-live-writer-2011/">change the posts folder of WLW</a> (Windows Live Writer):
 &gt; &gt; <em>1. Open up regedit (in Win7, just type “regedit” into the start menu) _ &lt;p&gt;_2.** <strong>Navigate to **HKEY_CURRENT_USER\Software\Microsoft\Windows Live\Writer</strong></em>  &lt;p&gt;<em>3. Right click on the “Writer” folder in the left pane and choose New &gt; String Value _ &lt;p&gt;_4. Name the value <strong>PostsDirectory</strong> and then double-click on it to edit _ &lt;p&gt;_a. You can try pointing it to your documents folder, which is normally “C:\Users\&lt;your-username&gt;\Documents\” in Win7 _ &lt;p&gt;_b. Or point it somewhere else. Note that Writer will create two child folders wherever you point it: <strong>Drafts</strong> and <strong>Recent Posts</strong>.</em> &lt;p&gt;The folder I switch to is a folder under the folder I keep synced with Live Mesh. On the other computer, do the same steps. Change the posts folder to the folder you keep synced with Live Mesh. You’ll need to copy your existing posts and drafts from their original location which normally is <strong><em>C:\Users[User Name]\Documents\My Weblog Posts</em></strong>  &lt;p&gt;Now you can start a post on my computer and finish it on the other. More importantly, you now have a backup of all your drafts on your SkyDrive.  &lt;p&gt;You can, of course, use Dropbox or any other synchronization service to keep the posts in sync.     </p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/MozillaBeyondFirefox">
        Mozilla: Beyond Firefox
      </a>
    </h1>

    <span class="post-date">07 Jan 2012</span>

    <p><img src="https://public.sn2.livefilestore.com/y1pGF5l4Bo9JwpsgxiwSamDSdDgtVKWikqOcXmBxiSBtqHiwS9MuT7yFG8q5PJySYYqLEcSFXovB5AXl20_1Zaz1Q/MozillaLogo.jpg?psid=1" alt="" />Who doesn’t already know <a href="http://www.mozilla.org/en-US/firefox/fx/">Firefox</a>? But what other projects is <a href="http://www.mozilla.org/">Mozilla</a> working on?  &lt;p align="justify"&gt;I’ve taken an interest lately in finding out more about Mozilla. I think it all started with reading some of the “<a href="https://wiki.mozilla.org/index.php?title=Mozilla.org/Contribute/Stories&amp;amp;diff=377200&amp;amp;oldid=prev" title="Mozilla.org/Contribute/Stories&amp;amp;diff=377200&amp;amp;oldid=prev">How I got started with Mozilla</a>” stories on the <a href="http://planet.mozilla.org/">Planet Mozilla</a> feed.  &lt;p align="justify"&gt;I’ve always been interested in Mozilla’s work. It’s not open source applications that they build. Most companies now build some tool and open the source code to everyone. This is a noble effort on their part but I don’t think that what open source development is about. It’s about “Open” before “Source”. Having a community-driven open development process is the key here. Involve the community in the process designing features, and building them. Invite developers to listen in on your meetings. It’s a great learning tool for new developers who can learn about what it’s like to work on a team. This is what I really admire about Mozilla, the open process. I’ll list later in this post some links on where you can see for yourself what I’m talking about.  &lt;p align="justify"&gt;
    Before I talk about all those projects, I want to take a moment to mention the <a href="http://www.mozilla.org/about/manifesto.en.html">Mozilla manifesto</a> (that I translated to <a href="http://www.mozilla.org/about/manifesto.ar.html">Arabic</a> back in 2009). Take a minute to read it. It might seem a high level goal that is not related to daily operations but reading a <a href="http://philikon.wordpress.com/2011/12/11/take-webos-mozilla/">post about webOS and Mozilla</a> lately, I watched how it’s on everyone’s mind. I think it really helps the mozillians stay focused on keeping the Internet open when they measure their decisions against the manifesto.</p>

<pre><code>### Firefox, Aurora and Nightly &lt;p align="justify"&gt;
There was always a nightly build of Firefox that if you search for it you can find an FTP page for it but it wasn’t official. With the new approach of versioning and releasing Firefox, nightly builds of Firefox have an official name “Nightly”. Last year, Mozilla came up with the 3 different names and [inspiring logos](http://downloadsquad.switched.com/2011/04/11/new-firefox-nightly-and-aurora-logos-unearthed-and-how-to-enabl/) to make it easier to adopt beta version. Firefox is the stable final release for the masses, Aurora is the beta release, it’s stable but could have few bugs. Nightly is cutting edge and updates every night. I use Nightly and love that there’s a 64 bit version of it. You can get it from [Nightly’s page](http://nightly.mozilla.org/). You can also follow Nightly news on [@FirefoxNightly](https://twitter.com/#!/firefoxnightly) or [Tumblr](http://firefoxnightly.tumblr.com/). They post details of the upcoming features. For more details, here’s [a complete list of features of Firefox, Aurora and Nightly](https://wiki.mozilla.org/Features/Release_Tracking). Here’s an example of a feature that should land soon in Nightly, the [new Home Tab](http://people.mozilla.com/~jboriss/specs/home_tab_first_iteration_spec1.png).

### Mozilla Labs

[Mozilla labs](http://mozillalabs.com/) is the home of many great ideas that usually are built as addons to Firefox. Some of these projects “graduate” and become part of Firefox like:

*   [Jetpack](http://mozillalabs.com/jetpack/): the restart-less addons platform.  &lt;li&gt;[Personas](http://mozillalabs.com/personas/): which provides an easy way to skin Firefox.  &lt;li&gt;[Sync](http://mozillalabs.com/sync/): the indispensable sync capability to keep your Firefox profile up to date on multiple computers.
</code></pre>
<p>
    Other projects are not so lucky and are not active anymore including:

    *   [Ubiquity](http://mozillalabs.com/ubiquity/): one of my favorite projects. Task-centric natural-language-based command line that brings web tasks from any web site to your fingertips. It's extensible and builds on web standards (HTML, CSS, and JavaScript).  <li>[Prism](http://mozillalabs.com/prism/): remember how Microsoft annoyed the heck out of everyone with “Pin a website to taskbar” feature in IE9. Well, before that there was Prism. Run any web app as a desktop application with the help of Firefox.
<p>
    Meanwhile, a number of projects is always active:

    *   [Test Pilot](http://mozillalabs.com/testpilot/): collects usage data and user feedback while maintaining user's privacy.  <li>[Contacts](http://mozillalabs.com/contacts/): centralizes the user's contacts in the browser and gives access to online services when requested and allowed.  <li>
        [Skywriter](http://mozillalabs.com/skywriter/): a web-based code editor.

        ### BrowserID
<p align="justify">[OpenID](http://en.wikipedia.org/wiki/OpenID) was a noble effort to outsource and centralize authentication of all the websites that we deal with everyday in a way that removes the hassle. For so reason, mainly the long ugly un-memorable URL, OpenID didn’t take over the web in the way it was hoped to.  <p align="justify">Mozilla is take a shot at this problem with [BrowserID](http://www.BrowserID.org). Instead of outsourcing authentication to a third party, BrowserID uses the browser to authenticate users using their email address. You add your address as your browser ID and verify it by clicking a link in an email you receive from the BrowserID service then every site wants to authenticate you can rely on BrowserID for that. Watch the video for a demo:  <p align="justify">
    &nbsp;
    <div style="padding-bottom: 0px; margin: 0px auto; padding-left: 0px; width: 640px; padding-right: 0px; display: block; float: none; padding-top: 0px" id="scid:5737277B-5D6D-4f48-ABFC-DD9C333F4C5D:e5f58bec-2a5d-4503-acd3-b13c02cd60a9" class="wlWriterEditableSmartContent"><div id="3c94f471-b6e4-4e40-a50c-33007c2b493c" style="margin: 0px; padding: 0px; display: inline;"><div>[![](http://lh4.ggpht.com/-TAgL3lauViw/Twkes5tnlmI/AAAAAAAAALg/hmIgdZ0IqfI/videoe8ad1aca041a%25255B8%25255D.jpg?imgmax=800)](http://www.youtube.com/watch?v=l0t9yDLAmFo)</div></div><div style="width:640px;clear:both;font-size:.8em">Introducing BrowserID from Mozilla</div></div>
<p>
    More info on BrowserID is [the introduction post](http://identity.mozilla.com/post/7616727542/introducing-browserid-a-better-way-to-sign-in) or on [Identity at Mozilla](http://identity.mozilla.com/) page. Here’s a [quick tutorial for developers](https://browserid.org/developers), the [demo site](http://myfavoritebeer.org/) from the video. You can follow the development or contribute on [Github](https://github.com/mozilla/browserid).

    ### WebFWD
<p align="justify">[WebFWD](https://webfwd.org) (Web Forward) is a new program from Mozilla to support open source projects with mentorship, access to Mozilla global network and infrastructure and resources. If you have an open source project that helps keep the web open, you can qualify for support from Mozilla. Read a brief introduction [here](https://webfwd.org/about/index.html) or follow the program’s news on their [blog](http://blog.webfwd.org/) or [@MozWebFWD](https://twitter.com/#!/mozwebfwd) or watch some [videos](http://vimeo.com/webfwd).  <p align="justify">
    [BigBlueButton](http://bigbluebutton.org/) is one of the projects participating in Mozilla’s WebFWD. It’s an open source project that enables universities and colleges to deliver high quality learning experience to remote students. Here are [some videos showing how BigBlueButton works](http://bigbluebutton.org/content/videos). It’s open source, [download it now](http://code.google.com/p/bigbluebutton/).

    ### Mozilla Popcorn
<p align="justify">[Mozilla Popcorn](http://mozillapopcorn.org/) tries to break videos from a big blob into browse-able element, this is how I see it. Videos, even though they’re everywhere on the web now, are still one element. You press play and watch. You can’t search in a video, you can’t make the video interact with other elements or contents that are related to this video. Popcorn tries to bring the web into video.  <p align="justify">
    Watch the [Shakespeare demo](http://katehudsondesign.com/demos/popcornmacbeth/) to get an idea of what Popcorn can do, it’s awesome (you’ll need a modern browser with HTML5 capabilities). Follow the project’s news on their [blog](http://mozillapopcorn.org/blog/) or [@PopcornJS](https://twitter.com/#!/popcornjs). [Download a copy](http://mozillapopcorn.org/popcornjs/), or [follow the development on Github](https://github.com/webmademovies/popcorn-js).

    ### What Else?
<p align="justify">There’s one more project I’d like to talk about, it’s the [Boot to Gecko mobile OS](https://wiki.mozilla.org/B2G). I think it’s a big enough topic that it merits its own post especially I don’t know much about it and would like to do more reading on it. If you have good resources on the topic, please mention them in the comments.  <p align="justify">This was a quick tour of the Mozilla projects that really interested me over those past couple of weeks. I’m sure there are much more of them our there. If the list is missing your favorite project, mention it in the comments or blog about it, I’d love to read more about it.  <p align="justify">Follow [@Firefox](https://twitter.com/#!/firefox) or on [Facebook](https://www.facebook.com/Firefox) or [Contribute](https://www.mozilla.org/contribute/) effort to the organization. Get some [Mozilla and Firefox gear](http://store.mozilla.org/) or [Donate and get a free shirt](https://donate.mozilla.org/page/contribute/openwebfund?WT.ac=shirt_us).     
</p></p></p></p></p></p></p></p></p></p></p></li></li></p></li></p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/OnAdBlocking">
        On Ad Blocking
      </a>
    </h1>

    <span class="post-date">19 Nov 2011</span>

    <p><img src="https://sn2files.storage.live.com/y1psAO-xkceSRTapjaHuBVdnuHqDWIWIgBZv77GMCa4_WRmzlRsWKEiNfi7VX2Js4-Ty8wzJbetSgA/AdBlockPlusLogo.jpg?psid=1" alt="" />I was reading this <a href="http://monogatari.doukut.su/2011/11/why-ad-blocking-is-not-moral-dilemma.html">blog post</a> on <a href="http://planet.mozilla.org/">Planet Mozilla</a> feed on the moral dilemma on using Ad blockers and I left a comment that is the idea behind this post. I use an <a href="http://adblockplus.org/en/">Ad blocker</a> and I’m aware that I’m not doing good to the sites that I visit. I agree that Ads build brand recognition and by not looking at them, I might be taking away revenue from those sites.</p>

<p>This is why I disable my Ad blocker for almost all the sites that:</p>

<ol>
  <li>
    <div align="justify">I use regularly and want to support.</div>
    <li>
<div align="justify">Their ads are not an assault on my eyes or doesn't offend me.</div>

I think that the reason this ad blocking started is because the ad providers (and indirectly the site owners) took unfair advantage of their users and threw all the crap that they could find at them (remember the [good old days of pop-ups](http://en.wikipedia.org/wiki/Pop-up_ad)).

Ad providers are doing a terrible job in matching sites’ content with ads. You go to a website to read a serious article and find an ad that is completely different and unserious just because this user's profile at the ad provider indicates that they might be interested in this ad.

Content is subtle, but visual distraction can't be ignored. Ads give no regard to the page's colors and insert a foreign object with completely different colors. Some ads don't even care about having the correct size. Example is below (Click for bigger picture).

[![](https://sn2files.storage.live.com/y1p45EfuhY4chPcYI6JkyfTQJNUMxU-JPbWOI2ea6dNa4eI8Y9GBjQ7EASelyXmaXZv9rObO373OV8/BestAdPlacementEver_Small.png?psid=1)](https://sn2files.storage.live.com/y1poMoLyNkn-tYzIXrwyX_zlN5N-H70SSh6lGEQSLzTqoRnSGuz0umrcP-kgJ9Q5kuRfiIXTCOmgsk/BestAdPlacementEver.png?psid=1)

Some sites don’t even care and display ads that are stupid and offensive. [Here’s an example](http://twitpic.com/5uhzn3) of a (supposed to be respected) newspaper web site displaying (what is practically if not really) ad for a porn site. Some web sites don’t care about their users as much as they care about ad revenue. I understand that it’s a tough business, but I know a bad business strategy when I see one. Having no minimum when it comes to what is an acceptable ad is a bad business strategy.

Some content provider think that “Content + Ad = Money” without thinking through what content or what ads. Those content providers will never imagine that one good option sometimes is displaying no ad at all. Users will respond to those providers by using Ad blockers.

Instead of considering whether or not ad blocking should be a moral dilemma (which I can actually agree on), we should ask ourselves 'Why are users blocking ads?'.
</li>
  </li>
</ol>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/MirroringHardDrivesUsingPowerShellAndSyncToy">
        Mirroring Hard drives Using PowerShell and SyncToy
      </a>
    </h1>

    <span class="post-date">18 Nov 2011</span>

    <p><img src="https://sn2files.storage.live.com/y1pEqScU3Qzm04LrZAfaxrVuyoZ5-bVd236pu-9bPHmIIU-XF6G4isOlmp7gE5PHZnQfi-4uKO9Y9s/PowerShellLogo.jpg?psid=1" alt="" /><img src="https://sn2files.storage.live.com/y1pcyUQd4CpJG44gFqyyO9-I9fFQC-Ru43151DTeqlrOZPHZ2GRZLbjiKbNPa2Jzb5HpXU0yTR9Q58/SyncToyLogo.jpg?psid=1" alt="" />My main protection against hard drive failure for a long time has been <a href="http://en.wikipedia.org/wiki/Standard_RAID_levels#RAID_1">RAID 1</a>. I would get two identical hard drives and RAID them so that everything I do on the first drive would be replicated on the second. One time, this actually saved me from a hard drive failure with almost zero down time.</p>

<p>I can say that this has worked out very well for a long time until one day I made a stupid mistake and accidently chose the wrong drive when installing Windows. I wiped out the data drive and sure enough RAID has mirrored everything I did. It was 4 days of crying, recovering data with <a href="http://diskdigger.org/">DiskDigger</a>, banging my head on the desk, recovering data, more crying, and so on. Since then, I dropped the RAID 1 on all my hard drives and switched to using SyncToy to mirror identical disks once a day.</p>

<p>SyncToy is very simple to use and you can <a href="http://www.pchell.com/support/synctoy.shtml">use it with Windows Task Scheduler</a> to sync the drives at night. However, I ran into two main problems: Copying SQL Server database files, and Copying mounted VHD files. These files won’t get copied if they’re in use. To solve this problem, I need to stop the SQL Server service, and un-mount the VHD file before mirroring the drives. To do that and after <a href="http://www.amreldib.com/2011/11/powershell-study-notes.html">learning all about it</a>, I’ll be using PowerShell.</p>

<h3 id="running-powershell-scripts">Running PowerShell Scripts</h3>

<p>The first thing to try out is running PowerShell scripts in Windows. If you’re running Windows 7 like I’m, you could run into the issue of restricted execution policy. If you try to run a PowerShell script, any script, you’ll find this error message:
 &gt; &lt;pre&gt;<em><strong>File C:\test.ps1 cannot be loaded because the execution of scripts is disabled on this system. **
&gt; **Please see “get-help about_signing” for more details.</strong></em>&lt;/pre&gt;</p>

<p>This is caused by Windows limiting the ability to run PowerShell scripts by default. You can get the status of the execution policy using the PowerShell cmdlet <strong><em>Get-ExecutionPolicy</em></strong></p>

<blockquote>
  <p><em><font color="#0000ff" face="Courier New">Get-ExecutionPolicy</font></em></p>
</blockquote>

<p>To change the status of the execution policy use the <strong><em>Set-ExecutionPolicy</em></strong> cmdlet. Here, I’m switching to “Unrestricted”:</p>

<blockquote>
  <p><em><font face="Courier New"><font color="#0000ff">Set-ExecutionPolicy</font> <font color="#0000a0">–ExecutionPolicy</font> <font color="#9b00d3">Unrestricted</font></font></em></p>
</blockquote>

<p>Changing the execution policy is a one-time thing, you won’t have to worry about it again. Now, your Windows 7 is ready to run PowerShell scripts. You can read all about execution policy and running PowerShell scripts on Windows in this <a href="http://technet.microsoft.com/en-us/library/ee176949.aspx">TechNet article</a>.</p>

<h3 id="running-powershell-scripts-using-task-scheduler">Running PowerShell Scripts using Task Scheduler</h3>

<p>The Task Scheduler will be responsible for running the script. It can’t run it directly, we’ll have to run PowerShell.exe and pass the script as an argument. It’s like running a PowerShell script from the command line. To do that we enter the PowerShell.exe path followed by <strong>“&amp;</strong> then the path to the script surrounded by single or double quotes (<a href="http://www.leeholmes.com/blog/2006/05/05/running-powershell-scripts-from-cmd-exe/">Source</a>). This helps with running scripts that have space in their path. Here’s an example:</p>

<blockquote>
  <p><em><font face="Courier New">**“C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe” “&amp; 'D:\Folder Name\Our Script.ps1'**</font></em></p>
</blockquote>

<h3 id="copying-database-files">Copying Database Files</h3>

<p>Before we start writing the script, we’ll have to test copying the database file. I stopped the SQL service using the Services management console and tried to copy the file but it failed. Database files by default are not owned by your Windows user account. You have to take ownership of the files (the MDF file and the Log file) and grant your Windows account sufficient permission to be able to copy the files. You can use the Properties dialog to take ownership of the files. I do that and now I can copy the files.</p>

<p>I can write all the commands in the PowerShell script directly, but I would rather break down the script into reusable functions. To prepare to copy the database files, I have 3 functions; check the status of the SQL service, stop the service and start it. I would like to maintain the status of my SQL service as it is after the mirroring is complete. I want to stop the service and start it again only if it was actually running.</p>

<p>Checking the service status, stopping it, and starting it is the same for all services and is not related to SQL Server. You can read all about it <a href="http://www.computerperformance.co.uk/powershell/powershell_service_start.htm">here</a>. We can simply use the commands <strong><em>Get-Service</em></strong>, <strong><em>Stop-Service</em></strong> and <strong><em>Start-Service</em></strong>.</p>

<p>I’m writing the functions in a bit of a generic way so that I can use them later in other scripts without having to change their content (only their name have to change). For example, I’m passing the name of the service. Here’s the <strong><em>Get-SqlServiceStatus</em></strong> function as an example:</p>

<blockquote>
  <p>_<font face="Courier New">
    [![Properties Window of SQL Service](https://sn2files.storage.live.com/y1px6JqF-PvGPZErGVqqnJG7MYACI6XJcxAoyxwoi3mt8qEYJTI0Jj88fmKP-ZVjJ1bCJR38-VYq0A/SqlServicePropertiesWindow.jpg?psid=1)](https://sn2files.storage.live.com/y1px6JqF-PvGPZErGVqqnJG7MYACI6XJcxAoyxwoi3mt8qEYJTI0Jj88fmKP-ZVjJ1bCJR38-VYq0A/SqlServicePropertiesWindow.jpg?psid=1)**<font color="#0000a0">function</font> <font color="#9b00d3">Get-SqlServiceStatus</font> (<font color="#ff0000">$serviceName</font>)
    &gt; {
    &gt; &nbsp;&nbsp;&nbsp; <font color="#008000"># Get a reference to the service</font>
    &gt; &nbsp;&nbsp;&nbsp; <font color="#ff0000">$sqlService</font> = <font color="#0000ff">Get-Service</font> <font color="#ff0000">$serviceName</font>**</font></p>
</blockquote>
<p>&lt;/font&gt;_
&gt;
&gt; <em><font face="Courier New">
    **&nbsp;&nbsp;&nbsp; <font color="#008000"># Return the service status</font>
    &gt; &nbsp;&nbsp;&nbsp; <font color="#0000ff">return</font> <font color="#ff0000">$sqlService</font>.status
    &gt; }**
</font></em></p>

<p>All I need now is the name of the SQL service on my computer. To get the name of the service, navigate to the service properties dialog and pick the name of the service (not the display name). Make sure to use PowerShell escape characters to enter the name correctly. For example: “<strong>MSSQL$SQLEXPRESS</strong>” have a dollar sign ($), so I have to add a backtick before the dollar sign to make PowerShell parse the name correctly “<strong>MSSQL`$SQLEXPRESS</strong>”.</p>

<p> </p>

<h3 id="mounting-vhds">Mounting VHDs</h3>

<p>I think that the common way to mount a VHD in PowerShell is using <a href="http://en.wikipedia.org/wiki/Windows_Management_Instrumentation">WMI</a> (Windows Management Instrumentation). A quick search online will confirm this. However, WMI is not available for Windows 7, it’s for Windows Server. We can’t mount the VHD file using WMI because the namespace “Root\Virtualization” is <a href="http://social.technet.microsoft.com/Forums/en-US/winserverpowershell/thread/a08ad18f-4b6a-46a0-bd1f-274fbbc5b737">not available on Windows 7</a>. This namespace include the class that could be used to mount the VHD file. If you’re running Windows Server and can use WMI, here’s a <a href="http://blogs.msdn.com/b/virtual_pc_guy/archive/2008/02/01/mounting-a-virtual-hard-disk-with-hyper-v.aspx">description of how to mount virtual hard drives with HyperV and WMI</a>.</p>

<p>Aside from using WMI, normally we’d mount a VHD using the <a href="http://www.windows7news.com/2010/01/14/how-to-automatically-attach-vhd-images-in-windows-7/">DiskPart command</a>. To do that, create a file and name it AttachMyVHD.s for example and add this to it:</p>

<blockquote>
  <p><code>_**select vdisk file=c:\MyVHD.vhd
attach vdisk**_</code></p>
</blockquote>

<p>Then create a Windows command (.cmd) file that call the diskpart command and pass this file to it.</p>

<blockquote>
  <p><code>_**DiskPart -s "c:\AttachMyVHD.s"**_</code></p>
</blockquote>

<p>In the S file, we’re selecting the VHD by specifying its location, then attaching it. In the Windows command file, we’re passing the S file to the DiskPart command.</p>

<p>In PowerShell, we’ll just execute the Windows command file. This <strong>Mount-Codebox</strong> function declares a variable with the location of the Windows command file. Codebox is the name of the VHD file I’m using.</p>

<blockquote>
  <p>_<font face="Courier New">
    **<font color="#0000a0">function</font> <font color="#9b00d3">Mount-Codebox</font>
    &gt; {
    &gt; &nbsp;&nbsp;&nbsp;&nbsp; <font color="#ff0000">$scriptFile</font> = ****<font color="#c0504d">
        “D:\VBox\HardDrives\AttachVHD.cmd”
        &gt;
    </font>&nbsp;&nbsp;&nbsp;&nbsp; <font color="#a5a5a5">&amp; </font><font color="#ff0000">$scriptFile</font>
    &gt; }**</font></p>
</blockquote>
<p>&lt;/font&gt;_</p>

<p>To unmount a VHD, you can do the same thing, except in the S file, use <strong><em>detach vdisk</em></strong> instead of <strong><em>attach vdisk</em></strong>.</p>

<p>Before we unmount the VHD and re-mount it after the mirroring, we need to check if it’s already mounted. We don’t want our script to change an existing status, we want it to maintain it. If the VHD is not already mounted, don’t try to unmount, then re-mount it at the end. Just skip this step altogether.</p>

<p>To check if the VHD is already mounted, we’ll just check if the drive it creates exists or not. To check if a drive exists, we’ll use the <strong><em><a href="http://powershell.com/cs/media/p/202.aspx">Exists-Drive function</a></em></strong>.</p>

<blockquote>
  <font face="Courier New">
    _**<font color="#0000a0">function</font> <font color="#9b00d3">Exists-Drive</font> (<font color="#ff0000">$driveletter</font>)
    &gt; {
    &gt; &nbsp;&nbsp;&nbsp; <font color="#ff0000">$drive</font> = <font color="#444444">New-Object</font> <font color="#9b00d3">System.IO.DriveInfo</font>(<font color="#ff0000">$driveletter</font>)
    &gt; &nbsp;&nbsp;&nbsp; <font color="#ff0000">$drive</font>.DriveType <font color="#a5a5a5">-ne</font> <font color="#c0504d">'NoRootDirectory'</font>&nbsp;&nbsp;
    &gt; }**_
</font>
</blockquote>
<p>&lt;/font&gt;</p>

<h3 id="run-synctoy">Run SyncToy</h3>

<p>To run SyncToy from PowerShell, we’ll use the same way we called the Windows command file above; using the <strong><em>&amp;</em></strong> symbol to execute the SyncToy EXE file. We’ll call the SyncToyCmd.exe file which is the command line equivalent of the application so we can pass the name of the backup plan as an argument. If you use the command line to call SyncToyCmd, it’ll look like this:</p>

<blockquote>
  <p><strong><em><font face="Courier New">SyncToyCmd –R “MyBackupPlan”</font></em></strong></p>
</blockquote>

<p>We’ll create the <strong><em>Run-SyncToy</em></strong> function with the backup plan name as an input so we can call it multiple times for different plans.</p>

<blockquote>
  <p>**_<font face="Courier New">
    <font color="#0000a0">function</font> <font color="#9b00d3">Run-SyncToy</font> (<font color="#ff0000">$backupPlan</font>)
    &gt; {
    &gt; &nbsp;&nbsp;&nbsp; <font color="#ff0000">$Exe</font> = <font color="#c0504d">"C:\Program Files\SyncToy 2.1\SyncToyCmd.exe"</font>
    &gt; &nbsp;&nbsp;&nbsp; &amp; <font color="#ff0000">$Exe</font> <font color="#0000a0">-R</font> <font color="#ff0000">$backupPlan</font>
    &gt; }</font></p>
</blockquote>
<p>&lt;/font&gt;_**</p>

<h3 id="write-powershell-output-to-file">Write PowerShell Output to File</h3>

<p>Logically, I’m running this script overnight and I would like to understand what happened while I’m away, so we’ll write the output of the script to a log file named with the date of when the script ran.</p>

<p>To write the output of any PowerShell command or function to file, use the <strong><em>Out-File</em></strong> cmdlet. This <a href="http://technet.microsoft.com/en-us/library/ee176924.aspx">TechNet page</a> explains how to use it. Example:</p>

<blockquote>
  <p><strong><em><font face="Courier New"><font color="#0000ff">Get-ChildItem</font> | <font color="#0000ff">out-file</font> <font color="#c0504d">"D:\MyOutputFile.txt"</font> <font color="#0000a0">-Append -Force</font> </font></em></strong></p>
</blockquote>

<p>This line write the output of the <strong><em>Get-ChildItem</em></strong> cmdlet to the text file named <strong><em>MyOutputFile.txt</em></strong> under the D drive. Notice the use of the two arguments –<strong><em>Append</em></strong>  (which appends to the file if it already exists) and –<strong><em>Force</em></strong> (which creates the file if it doesn’t exist).</p>

<p>We’ll need to stamp the file name with time of when the script ran, to do that we’ll use the <strong><em>Get-Date</em></strong> cmdlet and the argument –<strong><em>Format</em></strong>. Example:</p>

<blockquote>
  <p><em><strong><font face="Courier New"><font color="#0000ff">Get-Date</font> <font color="#0000a0">-format</font> <font color="#c0504d">"yyyy-MM-dd HH-mm-ss"</font></font></strong></em></p>
</blockquote>

<h3 id="putting-it-all-together">Putting It All Together</h3>

<p>You can notice that all the work above just creates functions to be used in the main body of the script. Here’s where we put it all together.</p>

<blockquote>
  <p>_**<font face="Courier New">
    <font color="#0000ff">Clear-Host</font>
    &gt; <font color="#008000">
        # Decleare variable to hold the service name
        &gt;
    </font><font color="#ff0000">$serviceName</font> = <font color="#c0504d">"MSSQL`$SQLEXPRESS"</font></font></p>
</blockquote>
<p>&lt;/font&gt;**_
&gt;
&gt; <em><strong><font face="Courier New">
    <font color="#008000"># Where the log file will be stored</font>
    &gt; <font color="#ff0000">$logHome</font> = <font color="#c0504d">"D:\Amr\Backup\BackupLogs\"</font>
</font></strong></em>
&gt;
&gt; <em><strong><font face="Courier New">
    <font color="#008000"># Get timestamp</font>
    &gt; <font color="#ff0000">$timeStamp</font> = <font color="#0000ff">Get-Date</font> <font color="#0000a0">-Format</font> <font color="#c0504d">"yyyy-MM-dd HH-mm-ss"</font>
</font></strong></em>
&gt;
&gt; <em><strong><font face="Courier New">
    <font color="#008000"># Generate name of log file</font>
    &gt; <font color="#ff0000">$logFile</font> = <font color="#ff0000">$logHome</font> + <font color="#c0504d">"Backup Log "</font> + <font color="#ff0000">$timeStamp</font> + <font color="#c0504d">".txt"</font>
</font></strong></em>
&gt;
&gt; <em><strong><font face="Courier New">
    <font color="#008000"># Write a starting message</font>
    &gt; <font color="#c0504d">"Starting backup at $timestamp"</font> <font color="#a5a5a5">|</font> <font color="#0000ff">out-file</font> <font color="#ff0000">$logFile</font> <font color="#0000a0">-Append -Force</font>
</font></strong></em>
&gt;
&gt; <em><strong><font face="Courier New">
    <font color="#008000">
        # Stop the SQL service if it's running
        &gt;
    </font><font color="#ff0000">$serviceStatus</font> = <font color="#0000ff">Get-SqlServiceStatus</font> (<font color="#ff0000">$serviceName</font>)
    &gt; <font color="#c0504d">"Service $serviceName is $serviceStatus."</font> <font color="#a5a5a5">|</font> <font color="#0000ff">out-file</font> <font color="#ff0000">$logFile</font> <font color="#0000a0">-Append -Force</font>
    &gt; <font color="#0000a0">if</font> (<font color="#ff0000">$serviceStatus</font> <font color="#a5a5a5">-eq</font> <font color="#c0504d">"Running"</font>)
    &gt; {
    &gt; &nbsp;&nbsp;&nbsp; <font color="#c0504d">"SQL service is running, stopping it..."</font> <font color="#a5a5a5">|</font> <font color="#0000ff">out-file</font> <font color="#ff0000">$logFile</font> <font color="#0000a0">-Append -Force</font>
    &gt; &nbsp;&nbsp;&nbsp; <font color="#0000ff">Stop-SqlService</font> (<font color="#ff0000">$serviceName</font>) <font color="#a5a5a5">|</font> <font color="#0000ff">out-file</font> <font color="#ff0000">$logFile</font> <font color="#0000a0">-Append -Force</font>
    &gt; }
</font></strong></em>
&gt;
&gt; <em><strong><font face="Courier New">
    <font color="#008000"># Unmount Codebox if it was already mounted</font>
    &gt; <font color="#ff0000">$CodeboxMounted</font> = <font color="#0000ff">Exists-Drive</font> <font color="#c0504d">
        "M:"
        &gt;
    </font><font color="#0000a0">if</font> (<font color="#ff0000">$CodeboxMounted</font> <font color="#a5a5a5">-eq</font> <font color="#c0504d">"True"</font>)
    &gt; {
    &gt; &nbsp;&nbsp;&nbsp; <font color="#c0504d">"Codebox is mounted. Unmounting Codebox..."</font> <font color="#a5a5a5">|</font> <font color="#0000ff">out-file</font> <font color="#ff0000">$logFile</font> <font color="#0000a0">-Append -Force</font>
    &gt; <font color="#008000">&nbsp;&nbsp;&nbsp; # Unmount Codebox</font>
    &gt; <font color="#0000ff">&nbsp;&nbsp;&nbsp; Unmount-Codebox</font> <font color="#a5a5a5">|</font> <font color="#0000ff">out-file</font> <font color="#ff0000">$logFile</font> <font color="#0000a0">-Append -Force</font>
    &gt; <font color="#c0504d">&nbsp;&nbsp;&nbsp; "Codebox is not mounted now."</font> <font color="#a5a5a5">|</font> <font color="#0000ff">out-file</font> <font color="#ff0000">$logFile</font> <font color="#0000a0">-Append -Force</font>
    &gt; }
    &gt; <font color="#0000a0">else</font>
    &gt; {
    &gt; &nbsp;&nbsp;&nbsp; <font color="#c0504d">"Codebox is not mounted"</font> <font color="#a5a5a5">|</font> <font color="#0000ff">out-file</font> <font color="#ff0000">$logFile</font> <font color="#0000a0">-Append -Force</font>
    &gt; }
</font></strong></em>
&gt;
&gt; <em><strong><font face="Courier New">
    <font color="#008000"># Run sync toy</font>
    &gt; <font color="#0000ff">Run-SyncToy</font> (<font color="#c0504d">"TestBackup"</font>) <font color="#a5a5a5">|</font> <font color="#0000ff">out-file</font> <font color="#ff0000">$logFile</font> <font color="#0000a0">-Append -Force</font>
</font></strong></em>
&gt;
&gt; <em><strong><font face="Courier New">
    <font color="#008000"># Mount Codebox if it was already mounted</font>
    &gt; <font color="#0000a0">if</font> (<font color="#ff0000">$CodeboxMounted</font> <font color="#a5a5a5">-eq</font> <font color="#c0504d">"True"</font>)
    &gt; {
    &gt; &nbsp;&nbsp;&nbsp; <font color="#c0504d">"Mounting Codebox..."</font> <font color="#a5a5a5">|</font> <font color="#0000ff">out-file</font> <font color="#ff0000">$logFile</font> <font color="#0000a0">-Append -Force</font>
    &gt; <font color="#008000">&nbsp;&nbsp;&nbsp; # Mount Codebox</font>
    &gt; <font color="#0000ff">&nbsp;&nbsp;&nbsp; Mount-Codebox</font> <font color="#a5a5a5">|</font> <font color="#0000ff">out-file</font> <font color="#ff0000">$logFile</font> <font color="#0000a0">-Append -Force</font>
    &gt; <font color="#c0504d">&nbsp;&nbsp;&nbsp; "Codebox is mounted now."</font> <font color="#a5a5a5">|</font> <font color="#0000ff">out-file</font> <font color="#ff0000">$logFile</font> <font color="#0000a0">-Append -Force</font>
    &gt; }
</font></strong></em>
&gt;
&gt; <em><strong><font face="Courier New">
    <font color="#008000"># Run the SQL service if it's stopped</font>
    &gt; <font color="#ff0000">$serviceStatus</font> = <font color="#0000ff">Get-SqlServiceStatus</font> (<font color="#ff0000">$serviceName</font>)
    &gt; <font color="#c0504d">"Service $serviceName is $serviceStatus."</font> <font color="#a5a5a5">|</font> <font color="#0000ff">out-file</font> <font color="#ff0000">$logFile</font> <font color="#0000a0">-Append -Force</font>
    &gt; <font color="#0000a0">if</font> (<font color="#ff0000">$serviceStatus</font> <font color="#a5a5a5">-eq</font> <font color="#c0504d">"Stopped"</font>)
    &gt; {
    &gt; &nbsp;&nbsp;&nbsp; <font color="#c0504d">"Starting SQL service..."</font> <font color="#a5a5a5">|</font> <font color="#0000ff">out-file</font> <font color="#ff0000">$logFile</font> <font color="#0000a0">-Append -Force</font>
    &gt; <font color="#0000ff">&nbsp;&nbsp;&nbsp; Start-SqlService</font> (<font color="#ff0000">$serviceName</font>) <font color="#a5a5a5">|</font> <font color="#0000ff">out-file</font> <font color="#ff0000">$logFile</font> <font color="#0000a0">-Append -Force</font>
    &gt; }
</font></strong></em>
&gt;
&gt; <em><strong><font face="Courier New">
    <font color="#008000"># Write end message</font>
    &gt; <font color="#ff0000">$finishTime</font> = <font color="#0000ff">Get-Date</font> <font color="#0000a0">-Format</font> <font color="#c0504d">"yyyy-MM-dd HH-mm-ss"</font>
    &gt; <font color="#c0504d">"Backup script finished at $finishTime"</font> <font color="#a5a5a5">|</font> <font color="#0000ff">out-file</font> <font color="#ff0000">$logFile</font> <font color="#0000a0">-Append -Force</font>
</font></strong></em></p>

<h3 id="try-it-out-yourself">Try It Out Yourself</h3>

<p>You probably have a different backup strategy, but you can still take advantage of PowerShell and SyncToy in a whole host of other scenarios. <a href="https://skydrive.live.com/?cid=a0f4e46186f7cce4&amp;sc=documents&amp;id=A0F4E46186F7CCE4%211240#">Download the script here</a>. Tweak it till it fit your requirements and please leave a comment below if you have a question or found a bug somewhere in the script. Even if not for mirroring hard drives, this still was a nice exercise for using PowerShell.</p>

<iframe style="padding-bottom: 0px; background-color: #fcfcfc; padding-left: 0px; width: 98px; padding-right: 0px; height: 115px; padding-top: 0px" title="Preview" marginheight="0" src="https://skydrive.live.com/embedicon.aspx/Public/Blog/Mirroring%20Hard%20Drives%20using%20PowerShell%20and%20SyncToy/MirrorDrives.ps1?cid=a0f4e46186f7cce4&amp;sc=documents" frameborder="0" marginwidth="0" scrolling="no"></iframe>

  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page5">Older</a>
  
  
    
      <a class="pagination-item newer" href="/page3">Newer</a>
    
  
</div>
    </div>

  </body>
</html>
