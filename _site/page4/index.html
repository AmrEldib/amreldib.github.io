<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  ﻿<head>
    <link href="http://gmpg.org/xfn/11" rel="profile">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <!-- Enable responsiveness on mobile devices-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <title>
        
        Amr &middot; 
        
    </title>
    <!-- CSS -->
    <link rel="stylesheet" href="/public/css/poole.css">
    <link rel="stylesheet" href="/public/css/syntax.css">
    <link rel="stylesheet" href="/public/css/hyde.css">
    <link rel="stylesheet" href="/public/css/rjow.css">
    <link rel="stylesheet" href="/public/css/amr.css">
    <link rel="stylesheet" href="/public/css/gist.css">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
    <!-- Icons -->
    <link rel="shortcut icon" href="/public/images/favicon.ico">
    <!-- For Chrome for Android: -->
    <link rel="icon" sizes="192x192" href="/public/images/AmrAvatar192.png">
    <!-- For iPhone 6 Plus with @3× display: -->
    <link rel="apple-touch-icon-precomposed" sizes="180x180" href="/public/images/AmrAvatar180.png">
    <!-- For iPad with @2× display running iOS ≥ 7: -->
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/public/images/AmrAvatar152.png">
    <!-- For iPad with @2× display running iOS ≤ 6: -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/images/AmrAvatar144.png">
    <!-- For iPhone with @2× display running iOS ≥ 7: -->
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/public/images/AmrAvatar120.png">
    <!-- For iPhone with @2× display running iOS ≤ 6: -->
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/public/images/AmrAvatar114.png">
    <!-- For the iPad mini and the first- and second-generation iPad (@1× display) on iOS ≥ 7: -->
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/public/images/AmrAvatar76.png">
    <!-- For the iPad mini and the first- and second-generation iPad (@1× display) on iOS ≤ 6: -->
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/public/images/AmrAvatar72.png">
    <!-- For non-Retina iPhone, iPod Touch, and Android 2.1+ devices: 57×57px -->
    <link rel="apple-touch-icon-precomposed" href="/public/images/AmrAvatar57.png">
    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="theme-jekyll">

    <div class="sidebar">
    <div class="container sidebar-sticky">
        <div class="sidebar-about">
            <div class="flip-container" ontouchstart="this.classList.toggle('hover');">
                <div class="flipper">
                    <div class="front">
                        <div><img class="profilePic" src="/public/images/AmrAvatar.png" /></div>
                    </div>
                    <div class="back">
                        <div><img class="profilePic" src="/public/images/Amr.png" /></div>
                    </div>
                </div>
            </div>
            <br/>
            <small><i>Hi, My name is</i></small>
            <h1>
                <a class="blogTitle" href="/">
                    Amr
                </a>
            </h1>
            <small><i>and this is my</i></small>
            <p class="lead">Blog and personal website
</p>
        </div>
        <nav class="sidebar-nav">
            <a class="sidebar-nav-item" href="/">Home</a>
            

            
            
                
                    
                
            
                
                    
                    <a class="sidebar-nav-item" href="/about.html">About Me</a>
                    
                
            
                
            
                
            
                
                    
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            

            <br/>

            <a class="sidebar-nav-item side-nav-icon" 
               href="https://twitter.com/AmrEldib">
                <img class="side-nav-icon"
                     src="/public/images/twitter-24.png"
                     alt="@AmrEldib" />
            </a>
            <a class="sidebar-nav-item side-nav-icon" 
               href="https://github.com/AmrEldib">
                <img class="side-nav-icon"
                     src="/public/images/github-24.png"
                     alt="GitHub Page" />
            </a>
            <a class="sidebar-nav-item side-nav-icon" 
               href="http://www.goodreads.com/AmrEldib">
                <img class="side-nav-icon"
                     src="/public/images/goodreads-24.png"
                     alt="Goodreads Shelf" />
            </a>
            <a class="sidebar-nav-item side-nav-icon"
               href="https://www.linkedin.com/in/AmrEldib">
                <img class="side-nav-icon"
                     src="/public/images/linked-24.png"
                     alt="LinkedIn Resume" />
            </a>
            <a class="sidebar-nav-item side-nav-icon" 
               href="http://feeds.feedburner.com/AmrEldib">
                <img class="side-nav-icon"
                     src="/public/images/rss-24.png"
                     alt="Subscribe via RSS" />
            </a>
        </nav>
        <p>
            <small><a href="">About this Site</a></small>
            <small>&copy; 2014. All rights reserved.</small>
        </p>
    </div>
</div>


    <div class="content container">
      <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/SyncWindowsLiveWriterPostsBetweenComputers">
        Sync Windows Live Writer Posts Between Computers
      </a>
    </h1>

    <span class="post-date">11 Jan 2012</span>

    <p><img class="imageOnRight" title="Windows Live Writer" src="/public/images/SyncWLW/Windows_Live_Writer_logo.png" /></p>

<p>With all the different PCs between work and home, desktops and laptops, synchronization is becoming very important. I wanted to sync blog drafts between different computers which turned out to be very simple. Unfortunately, Windows Live doesn’t offer a solution out of the box, even though Windows Live Essentials comes with Live Mesh along with Live Writer. It’s a matter of putting two and two together which what I’ll do.</p>

<p>First, <a href="http://www.lehsys.com/2011/04/how-to-change-the-drafts-and-recent-posts-folder-in-windows-live-writer-2011/">change the posts folder of WLW</a> (Windows Live Writer):
1. Open up regedit (in Win7, just type “regedit” into the start menu).<br />
2. Navigate to <strong>HKEY_CURRENT_USER\Software\Microsoft\Windows Live\Writer</strong><br />
3. Right click on the “Writer” folder in the left pane and choose New &gt; String Value<br />
4. Name the value <strong>PostsDirectory</strong> and then double-click on it to edit:<br />
	- You can try pointing it to your documents folder, which is normally “C:\Users\&lt;your-username&gt;\Documents" in Win7<br />
	- Or point it somewhere else. Note that Writer will create two child folders wherever you point it: <strong>Drafts</strong> and <strong>Recent Posts</strong>.  </p>

<p>The folder I switch to is a folder under the folder I keep synced with Live Mesh. On the other computer, do the same steps. Change the posts folder to the folder you keep synced with Live Mesh. You’ll need to copy your existing posts and drafts from their original location which normally is <strong><em>C:\Users[User Name]\Documents\My Weblog Posts</em></strong> <br />
Now you can start a post on my computer and finish it on the other. More importantly, you now have a backup of all your drafts on your SkyDrive.<br />
You can, of course, use Dropbox or any other synchronization service to keep the posts in sync.     </p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/MozillaBeyondFirefox">
        Mozilla: Beyond Firefox
      </a>
    </h1>

    <span class="post-date">07 Jan 2012</span>

    <p><img class="imageOnRight" title="Mozilla" src="/public/images/MozillaBeyondFirefox/MozillaLogo.jpg" />  </p>

<p>Who doesn’t already know <a href="http://www.mozilla.org/en-US/firefox/fx/">Firefox</a>? But what other projects is <a href="http://www.mozilla.org/">Mozilla</a> working on? <br />
I’ve taken an interest lately in finding out more about Mozilla. I think it all started with reading some of the “<a href="https://wiki.mozilla.org/index.php?title=Mozilla.org/Contribute/Stories&amp;amp;diff=377200&amp;amp;oldid=prev" title="Mozilla.org/Contribute/Stories&amp;amp;diff=377200&amp;amp;oldid=prev">How I got started with Mozilla</a>” stories on the <a href="http://planet.mozilla.org/">Planet Mozilla</a> feed. <br />
I’ve always been interested in Mozilla’s work. It’s not open source applications that they build. Most companies now build some tool and open the source code to everyone. This is a noble effort on their part but I don’t think that what open source development is about. It’s about “Open” before “Source”. Having a community-driven open development process is the key here. Involve the community in the process designing features, and building them. Invite developers to listen in on your meetings. It’s a great learning tool for new developers who can learn about what it’s like to work on a team. This is what I really admire about Mozilla, the open process. I’ll list later in this post some links on where you can see for yourself what I’m talking about.  </p>

<p>Before I talk about all those projects, I want to take a moment to mention the <a href="http://www.mozilla.org/about/manifesto.en.html">Mozilla manifesto</a> (which I translated to <a href="http://www.mozilla.org/about/manifesto.ar.html">Arabic</a> back in 2009). Take a minute to read it. It might seem a high level goal that is not related to daily operations but reading a <a href="http://philikon.wordpress.com/2011/12/11/take-webos-mozilla/">post about webOS and Mozilla</a> lately, I watched how it’s on everyone’s mind. I think it really helps the mozillians stay focused on keeping the Internet open when they measure their decisions against the manifesto.  </p>

<h3 id="firefox-aurora-and-nightly">Firefox, Aurora and Nightly</h3>
<p>There was always a nightly build of Firefox that if you search for it you can find an FTP page for it but it wasn’t official. With the new approach of versioning and releasing Firefox, nightly builds of Firefox have an official name “Nightly”. Last year, Mozilla came up with the 3 different names and <a href="http://downloadsquad.switched.com/2011/04/11/new-firefox-nightly-and-aurora-logos-unearthed-and-how-to-enabl/">inspiring logos</a> to make it easier to adopt beta version. Firefox is the stable final release for the masses, Aurora is the beta release, it’s stable but could have few bugs. Nightly is cutting edge and updates every night. I use Nightly and love that there’s a 64 bit version of it. You can get it from <a href="http://nightly.mozilla.org/">Nightly’s page</a>. You can also follow Nightly news on <a href="https://twitter.com/#!/firefoxnightly">@FirefoxNightly</a> or <a href="http://firefoxnightly.tumblr.com/">Tumblr</a>. They post details of the upcoming features. For more details, here’s <a href="https://wiki.mozilla.org/Features/Release_Tracking">a complete list of features of Firefox, Aurora and Nightly</a>. Here’s an example of a feature that should land soon in Nightly, the <a href="http://people.mozilla.com/~jboriss/specs/home_tab_first_iteration_spec1.png">new Home Tab</a>.</p>

<h3 id="mozilla-labs">Mozilla Labs</h3>

<p><a href="http://mozillalabs.com/">Mozilla labs</a> is the home of many great ideas that usually are built as addons to Firefox. Some of these projects “graduate” and become part of Firefox like:<br />
- <a href="http://mozillalabs.com/jetpack/">Jetpack</a>: the restart-less addons platform.<br />
- <a href="http://mozillalabs.com/personas/">Personas</a>: which provides an easy way to skin Firefox.<br />
- <a href="http://mozillalabs.com/sync/">Sync</a>: the indispensable sync capability to keep your Firefox profile up to date on multiple computers.</p>

<p>Other projects are not so lucky and are not active anymore including:</p>

<ul>
  <li><a href="http://mozillalabs.com/ubiquity/">Ubiquity</a>: one of my favorite projects. Task-centric natural-language-based command line that brings web tasks from any web site to your fingertips. It’s extensible and builds on web standards (HTML, CSS, and JavaScript).  </li>
  <li><a href="http://mozillalabs.com/prism/">Prism</a>: remember how Microsoft annoyed the heck out of everyone with the new innovation “Pin a website to taskbar” feature in IE9. Well, before that there was Prism. Run any web app as a desktop application with the help of Firefox.  </li>
</ul>

<p>Meanwhile, a number of projects is always active:</p>

<ul>
  <li><a href="http://mozillalabs.com/testpilot/">Test Pilot</a>: collects usage data and user feedback while maintaining user’s privacy.  &lt;li&gt;<a href="http://mozillalabs.com/contacts/">Contacts</a>: centralizes the user’s contacts in the browser and gives access to online services when requested and allowed.  </li>
  <li><a href="http://mozillalabs.com/skywriter/">Skywriter</a>: a web-based code editor.</li>
</ul>

<h3 id="browserid">BrowserID</h3>
<p><a href="http://en.wikipedia.org/wiki/OpenID">OpenID</a> was a noble effort to outsource and centralize authentication of all the websites that we deal with everyday in a way that removes the hassle. For so reason, mainly the long ugly un-memorable URL, OpenID didn’t take over the web in the way it was hoped to.<br />
Mozilla is take a shot at this problem with <a href="http://www.BrowserID.org">BrowserID</a>. Instead of outsourcing authentication to a third party, BrowserID uses the browser to authenticate users using their email address. You add your address as your browser ID and verify it by clicking a link in an email you receive from the BrowserID service then every site wants to authenticate you can rely on BrowserID for that. Watch the video for a demo:  </p>

<iframe width="750" height="422" src="//www.youtube.com/embed/l0t9yDLAmFo" frameborder="0" allowfullscreen=""></iframe>

<p>More info on BrowserID is <a href="http://identity.mozilla.com/post/7616727542/introducing-browserid-a-better-way-to-sign-in">the introduction post</a> or on <a href="http://identity.mozilla.com/">Identity at Mozilla</a> page. Here’s a <a href="https://browserid.org/developers">quick tutorial for developers</a>, the <a href="http://myfavoritebeer.org/">demo site</a> from the video. You can follow the development or contribute on <a href="https://github.com/mozilla/browserid">Github</a>.</p>

<h3 id="webfwd">WebFWD</h3>
<p><a href="https://webfwd.org">WebFWD</a> (Web Forward) is a new program from Mozilla to support open source projects with mentorship, access to Mozilla global network and infrastructure and resources. If you have an open source project that helps keep the web open, you can qualify for support from Mozilla. Read a brief introduction <a href="https://webfwd.org/about/index.html">here</a> or follow the program’s news on their <a href="http://blog.webfwd.org/">blog</a> or <a href="https://twitter.com/#!/mozwebfwd">@MozWebFWD</a> or watch some <a href="http://vimeo.com/webfwd">videos</a>.<br />
<a href="http://bigbluebutton.org/">BigBlueButton</a> is one of the projects participating in Mozilla’s WebFWD. It’s an open source project that enables universities and colleges to deliver high quality learning experience to remote students. Here are <a href="http://bigbluebutton.org/content/videos">some videos showing how BigBlueButton works</a>. It’s open source, <a href="http://code.google.com/p/bigbluebutton/">download it now</a>.</p>

<h3 id="mozilla-popcorn">Mozilla Popcorn</h3>
<p><a href="http://mozillapopcorn.org/">Mozilla Popcorn</a> tries to break videos from a big blob into browse-able element, this is how I see it. Videos, even though they’re everywhere on the web now, are still one element. You press play and watch. You can’t search in a video, you can’t make the video interact with other elements or contents that are related to this video. Popcorn tries to bring the web into video.  </p>

<p>Watch the <a href="http://katehudsondesign.com/demos/popcornmacbeth/">Shakespeare demo</a> to get an idea of what Popcorn can do, it’s awesome (you’ll need a modern browser with HTML5 capabilities). Follow the project’s news on their <a href="http://mozillapopcorn.org/blog/">blog</a> or <a href="https://twitter.com/#!/popcornjs">@PopcornJS</a>. <a href="http://mozillapopcorn.org/popcornjs/">Download a copy</a>, or <a href="https://github.com/webmademovies/popcorn-js">follow the development on Github</a>.</p>

<h3 id="what-else">What Else?</h3>
<p>There’s one more project I’d like to talk about, it’s the <a href="https://wiki.mozilla.org/B2G">Boot to Gecko mobile OS</a>. I think it’s a big enough topic that it merits its own post especially I don’t know much about it and would like to do more reading on it. If you have good resources on the topic, please mention them in the comments.<br />
This was a quick tour of the Mozilla projects that really interested me over those past couple of weeks. I’m sure there are much more of them our there. If the list is missing your favorite project, mention it in the comments or blog about it, I’d love to read more about it.<br />
Follow <a href="https://twitter.com/#!/firefox">@Firefox</a> or on <a href="https://www.facebook.com/Firefox">Facebook</a> or <a href="https://www.mozilla.org/contribute/">Contribute</a> effort to the organization. Get some <a href="http://store.mozilla.org/">Mozilla and Firefox gear</a> or <a href="https://donate.mozilla.org/page/contribute/openwebfund?WT.ac=shirt_us">Donate and get a free shirt</a>.     </p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/OnAdBlocking">
        On Ad Blocking
      </a>
    </h1>

    <span class="post-date">19 Nov 2011</span>

    <p><img class="imageOnRight" title="AdBlock Plus" src="/public/images/AdBlocking/AdBlockPlusLogo.jpg" /></p>

<p>I was reading this <a href="http://monogatari.doukut.su/2011/11/why-ad-blocking-is-not-moral-dilemma.html">blog post</a> on <a href="http://planet.mozilla.org/">Planet Mozilla</a> feed on the moral dilemma on using Ad blockers and I left a comment that is the idea behind this post. I use an <a href="http://adblockplus.org/en/">Ad blocker</a> and I’m aware that I’m not doing good to the sites that I visit. I agree that Ads build brand recognition and by not looking at them, I might be taking away revenue from those sites.</p>

<p>This is why I disable my Ad blocker for almost all the sites that:</p>

<ol>
  <li>I use regularly and want to support.  </li>
  <li>Their ads are not an assault on my eyes or doesn’t offend me.  </li>
</ol>

<p>I think that the reason this ad blocking started is because the ad providers (and indirectly the site owners) took unfair advantage of their users and threw all the crap that they could find at them (remember the <a href="http://en.wikipedia.org/wiki/Pop-up_ad">good old days of pop-ups</a>).</p>

<p>Ad providers are doing a terrible job in matching sites’ content with ads. You go to a website to read a serious article and find an ad that is completely different and unserious just because this user’s profile at the ad provider indicates that they might be interested in this ad.</p>

<p>Content is subtle, but visual distraction can’t be ignored. Ads give no regard to the page’s colors and insert a foreign object with completely different colors. Some ads don’t even care about having the correct size. Example is below (Click for bigger picture).</p>

<p><a href="/public/images/AdBlocking/BestAdPlacementEver.jpg"><img class="imageInCenter" title="Best Ad Placement Ever!" src="/public/images/AdBlocking/BestAdPlacementEver_Small.jpg" /></a></p>

<p>Some sites don’t even care and display ads that are stupid and offensive. <a href="/public/images/AdBlocking/AwfulAd.jpg">Here’s an example</a> of a (supposed to be respected) newspaper web site displaying (what is practically if not really) ad for a porn site. Some web sites don’t care about their users as much as they care about ad revenue. I understand that it’s a tough business, but I know a bad business strategy when I see one. Having no minimum when it comes to what is an acceptable ad is a bad business strategy.</p>

<p>Some content provider think that “Content + Ad = Money” without thinking through what content or what ads. Those content providers will never imagine that one good option sometimes is displaying no ad at all. Users will respond to those providers by using Ad blockers.</p>

<p>Instead of considering whether or not ad blocking should be a moral dilemma (which I can actually agree on), we should ask ourselves ‘Why are users blocking ads?’.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/MirroringHardDrivesUsingPowerShellAndSyncToy">
        Mirroring Hard drives Using PowerShell and SyncToy
      </a>
    </h1>

    <span class="post-date">18 Nov 2011</span>

    <p><img class="imageOnRight" title="PowerShell" src="/public/images/MirrorHardDrives/PowerShellLogo.jpg" />
<img class="imageOnRight" title="SyncToy" src="/public/images/MirrorHardDrives/SyncToyLogo.jpg" /></p>

<p>My main protection against hard drive failure for a long time has been <a href="http://en.wikipedia.org/wiki/Standard_RAID_levels#RAID_1">RAID 1</a>. I would get two identical hard drives and RAID them so that everything I do on the first drive would be replicated on the second. One time, this actually saved me from a hard drive failure with almost zero down time.</p>

<p>I can say that this has worked out very well for a long time until one day I made a stupid mistake and accidently chose the wrong drive when installing Windows. I wiped out the data drive and sure enough RAID has mirrored everything I did. It was 4 days of crying, recovering data with <a href="http://diskdigger.org/">DiskDigger</a>, banging my head on the desk, recovering data, more crying, and so on. Since then, I dropped the RAID 1 on all my hard drives and switched to using SyncToy to mirror identical disks once a day.</p>

<p>SyncToy is very simple to use and you can <a href="http://www.pchell.com/support/synctoy.shtml">use it with Windows Task Scheduler</a> to sync the drives at night. However, I ran into two main problems: Copying SQL Server database files, and Copying mounted VHD files. These files won’t get copied if they’re in use. To solve this problem, I need to stop the SQL Server service, and un-mount the VHD file before mirroring the drives. To do that and after <a href="http://www.amreldib.com/2011/11/powershell-study-notes.html">learning all about it</a>, I’ll be using PowerShell.</p>

<h3 id="running-powershell-scripts">Running PowerShell Scripts</h3>

<p>The first thing to try out is running PowerShell scripts in Windows. If you’re running Windows 7 like I’m, you could run into the issue of restricted execution policy. If you try to run a PowerShell script, any script, you’ll find this error message:  </p>

<blockquote>
  <p>File C:\test.ps1 cannot be loaded because the execution of scripts is disabled on this system.<br />
Please see “get-help about_signing” for more details.</p>
</blockquote>

<p>This is caused by Windows limiting the ability to run PowerShell scripts by default. You can get the status of the execution policy using the PowerShell cmdlet <strong><em>Get-ExecutionPolicy</em></strong></p>

<script src="https://gist.github.com/AmrEldib/9d8b320ac7052d41ac21.js"></script>

<p>To change the status of the execution policy use the <strong><em>Set-ExecutionPolicy</em></strong> cmdlet. Here, I’m switching to “Unrestricted”:</p>

<script src="https://gist.github.com/AmrEldib/e54827459976f658bfd9.js"></script>

<p>Changing the execution policy is a one-time thing, you won’t have to worry about it again. Now, your Windows 7 is ready to run PowerShell scripts. You can read all about execution policy and running PowerShell scripts on Windows in this <a href="http://technet.microsoft.com/en-us/library/ee176949.aspx">TechNet article</a>.</p>

<h3 id="running-powershell-scripts-using-task-scheduler">Running PowerShell Scripts using Task Scheduler</h3>

<p>The Task Scheduler will be responsible for running the script. It can’t run it directly, we’ll have to run PowerShell.exe and pass the script as an argument. It’s like running a PowerShell script from the command line. To do that we enter the PowerShell.exe path followed by <strong>“&amp;</strong> then the path to the script surrounded by single or double quotes (<a href="http://www.leeholmes.com/blog/2006/05/05/running-powershell-scripts-from-cmd-exe/">Source</a>). This helps with running scripts that have space in their path. Here’s an example:</p>

<script src="https://gist.github.com/AmrEldib/69e497e506991ef80213.js"></script>

<h3 id="copying-database-files">Copying Database Files</h3>

<p>Before we start writing the script, we’ll have to test copying the database file. I stopped the SQL service using the Services management console and tried to copy the file but it failed. Database files by default are not owned by your Windows user account. You have to take ownership of the files (the MDF file and the Log file) and grant your Windows account sufficient permission to be able to copy the files. You can use the Properties dialog to take ownership of the files. I do that and now I can copy the files.</p>

<p>I can write all the commands in the PowerShell script directly, but I would rather break down the script into reusable functions. To prepare to copy the database files, I have 3 functions; check the status of the SQL service, stop the service and start it. I would like to maintain the status of my SQL service as it is after the mirroring is complete. I want to stop the service and start it again only if it was actually running.</p>

<p>Checking the service status, stopping it, and starting it is the same for all services and is not related to SQL Server. You can read all about it <a href="http://www.computerperformance.co.uk/powershell/powershell_service_start.htm">here</a>. We can simply use the commands <strong><em>Get-Service</em></strong>, <strong><em>Stop-Service</em></strong> and <strong><em>Start-Service</em></strong>.</p>

<p>I’m writing the functions in a bit of a generic way so that I can use them later in other scripts without having to change their content (only their name have to change). For example, I’m passing the name of the service. Here’s the <strong><em>Get-SqlServiceStatus</em></strong> function as an example:</p>

<script src="https://gist.github.com/AmrEldib/de4e018fe11a98b42a18.js"></script>

<p><img style="float: right" src="/public/images/MirrorHardDrives/SqlServicePropertiesWindow.jpg" /></p>

<p>All I need now is the name of the SQL service on my computer. To get the name of the service, navigate to the service properties dialog and pick the name of the service (not the display name). Make sure to use PowerShell escape characters to enter the name correctly. For example: “<strong>MSSQL$SQLEXPRESS</strong>” have a dollar sign ($), so I have to add a backtick before the dollar sign to make PowerShell parse the name correctly “<strong>MSSQL`$SQLEXPRESS</strong>”.</p>

<h3 id="mounting-vhds">Mounting VHDs</h3>

<p>I think that the common way to mount a VHD in PowerShell is using <a href="http://en.wikipedia.org/wiki/Windows_Management_Instrumentation">WMI</a> (Windows Management Instrumentation). A quick search online will confirm this. However, WMI is not available for Windows 7, it’s for Windows Server. We can’t mount the VHD file using WMI because the namespace “Root\Virtualization” is <a href="http://social.technet.microsoft.com/Forums/en-US/winserverpowershell/thread/a08ad18f-4b6a-46a0-bd1f-274fbbc5b737">not available on Windows 7</a>. This namespace include the class that could be used to mount the VHD file. If you’re running Windows Server and can use WMI, here’s a <a href="http://blogs.msdn.com/b/virtual_pc_guy/archive/2008/02/01/mounting-a-virtual-hard-disk-with-hyper-v.aspx">description of how to mount virtual hard drives with HyperV and WMI</a>.</p>

<p>Aside from using WMI, normally we’d mount a VHD using the <a href="http://www.windows7news.com/2010/01/14/how-to-automatically-attach-vhd-images-in-windows-7/">DiskPart command</a>. To do that, create a file and name it AttachMyVHD.s for example and add this to it:  </p>

<script src="https://gist.github.com/AmrEldib/b47cb7552a1c3f0f7b19.js"></script>

<p>Then create a Windows command (.cmd) file that call the diskpart command and pass this file to it.  </p>

<script src="https://gist.github.com/AmrEldib/d46e8dc1768e7ea1d656.js"></script>

<p>In the S file, we’re selecting the VHD by specifying its location, then attaching it. In the Windows command file, we’re passing the S file to the DiskPart command.</p>

<p>In PowerShell, we’ll just execute the Windows command file. This <strong>Mount-Codebox</strong> function declares a variable with the location of the Windows command file. Codebox is the name of the VHD file I’m using.  </p>

<script src="https://gist.github.com/AmrEldib/051466db496e139157e7.js"></script>

<p>To unmount a VHD, you can do the same thing, except in the S file, use <strong><em>detach vdisk</em></strong> instead of <strong><em>attach vdisk</em></strong>.</p>

<p>Before we unmount the VHD and re-mount it after the mirroring, we need to check if it’s already mounted. We don’t want our script to change an existing status, we want it to maintain it. If the VHD is not already mounted, don’t try to unmount, then re-mount it at the end. Just skip this step altogether.</p>

<p>To check if the VHD is already mounted, we’ll just check if the drive it creates exists or not. To check if a drive exists, we’ll use the <strong><em><a href="http://powershell.com/cs/media/p/202.aspx">Exists-Drive function</a></em></strong>.  </p>

<script src="https://gist.github.com/AmrEldib/344b1f9540712a2bc064.js"></script>

<h3 id="run-synctoy">Run SyncToy</h3>

<p>To run SyncToy from PowerShell, we’ll use the same way we called the Windows command file above; using the <strong><em>&amp;</em></strong> symbol to execute the SyncToy EXE file. We’ll call the SyncToyCmd.exe file which is the command line equivalent of the application so we can pass the name of the backup plan as an argument. If you use the command line to call SyncToyCmd, it’ll look like this:  </p>

<script src="https://gist.github.com/AmrEldib/e6ae51bdea7072ccce1d.js"></script>

<p>We’ll create the <strong><em>Run-SyncToy</em></strong> function with the backup plan name as an input so we can call it multiple times for different plans.  </p>

<script src="https://gist.github.com/AmrEldib/dd5fbc9b204197435976.js"></script>

<h3 id="write-powershell-output-to-file">Write PowerShell Output to File</h3>

<p>Logically, I’m running this script overnight and I would like to understand what happened while I’m away, so we’ll write the output of the script to a log file named with the date of when the script ran.</p>

<p>To write the output of any PowerShell command or function to file, use the <strong><em>Out-File</em></strong> cmdlet. This <a href="http://technet.microsoft.com/en-us/library/ee176924.aspx">TechNet page</a> explains how to use it. Example:</p>

<script src="https://gist.github.com/AmrEldib/3581c3aff5aee81dc2f9.js"></script>

<p>This line write the output of the <strong><em>Get-ChildItem</em></strong> cmdlet to the text file named <strong><em>MyOutputFile.txt</em></strong> under the D drive. Notice the use of the two arguments –<strong><em>Append</em></strong>  (which appends to the file if it already exists) and –<strong><em>Force</em></strong> (which creates the file if it doesn’t exist).</p>

<p>We’ll need to stamp the file name with time of when the script ran, to do that we’ll use the <strong><em>Get-Date</em></strong> cmdlet and the argument –<strong><em>Format</em></strong>. Example:  </p>

<script src="https://gist.github.com/AmrEldib/4eaa69ac18f22a30d78b.js"></script>

<h3 id="putting-it-all-together">Putting It All Together</h3>

<p>You can notice that all the work above just creates functions to be used in the main body of the script. Here’s where we put it all together.</p>

<script src="https://gist.github.com/AmrEldib/e1a12ddee601bd80480c.js"></script>

<h3 id="try-it-out-yourself">Try It Out Yourself</h3>

<p>You probably have a different backup strategy, but you can still take advantage of PowerShell and SyncToy in a whole host of other scenarios. <a href="https://gist.github.com/AmrEldib/e1a12ddee601bd80480c/download">Download the script here</a>. Tweak it till it fit your requirements and please leave a comment below if you have a question or found a bug somewhere in the script. Even if not for mirroring hard drives, this still was a nice exercise for using PowerShell.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/HowToRuinYourPublicBeta">
        How To Ruin Your Public Beta
      </a>
    </h1>

    <span class="post-date">05 Nov 2011</span>

    <p><img class="imageOnRight" title="Adobe" src="/public/images/HowToRuinPublicBeta/AdobeLogo.jpg" /></p>

<p>Couple of days ago, I downloaded and installed the latest beta of Adobe Flash (11.2.202.18 Beta 1). I downloaded the IE version and the non-IE version, and the x64 version. I like to test out the latest betas of almost all the software that I’m using; <a href="http://www.amreldib.com/2011/10/what-i-use-part-2.html">I use Mozilla Nightly and Chrome beta</a> (just updated to version 17 today). It’s my way of staying updated and keeping up with what’s coming next. I understand that I have to take some hits for using beta software but in return I get to enjoy all the new ideas months before everyone else, and every once in a blue moon I get to affect some feature in some upcoming release by providing feedback.</p>

<p>After I installed Flash, I started noticing this annoying beta disclaimer appearing on YouTube videos (a Flash element).</p>

<p><img class="imageInCenter" title="Beta disclaimer on YouTube Videos" src="/public/images/HowToRuinPublicBeta/FlashBetaDisclaimer01.png" /></p>

<p><img class="imageOnRight" title="Beta disclaimer on Audible Sample button" src="/public/images/HowToRuinPublicBeta/FlashBetaDisclaimer02.png" /></p>

<p>I ignored it at first, but then it started being really annoying. It’s hiding the full screen button in the YouTube player as you can see above. Then it started to get really annoying when it showed up on really small Flash elements; elements that are so small that I couldn’t see anything other than the disclaimer (look at the small Audible “Sample” button on the right). Naturally, I turned to Bing to start finding a solution for this annoyance. I found this <a href="http://forums.adobe.com/thread/797926?start=0&amp;tstart=0">post on Adobe forums</a>. Here’s the answer from an Adobe employee:  </p>

<blockquote>
  <p><em>Incubator builds are not preview, alpha or beta quality. It’s before that state - this is code under active development. The watermark is a visual indicator of that fact. Many companies follow this practice for pre-release software - <strong>for example, Microsoft Windows pre-release builds have a watermark with version in the bottom right corner of the screen</strong> to indicate it an evaluation and not a final version.</em></p>
</blockquote>

<p><em>Also, Flash Player is one of the most widely distributed pieces of software and our audience is quite broad. End users are by far our biggest customer segment. <strong>We need to make sure people - developer or end user - that install Incubator builds know and understand what they’re getting themselves into.</strong> In the past, we have seen links to previews and betas delivered out of context of the content we have on Labs that explains that pre-releases have not yet gone through security review, may not be stable, etc. These builds don’t give users auto-update notification and can make it difficult for a user to install a release player (because it is a later version, or you must run the uninstaller before you install a different version).</em></p>

<p>So, there’s no way to remove the disclaimer. Now, beta users who are willing to use such an early beta of a software like Flash (which is a component more than a software) are not stupid users. They understand that this is a beta, they accept the risks of using such a software, they just don’t want to be annoyed by a stupid disclaimer.</p>

<p>Someone argued in the forum post with a beta user about how Adobe is right and the beta users are wrong in complaining about this. One thing said is:  </p>

<blockquote>
  <p><em>With all due respect tom, your comments are the very reason why Adobe tends not to let things publically available this early. They are afraid that people like you will make comments/judgments like this. You need to understand a little bit about software development, this is called an alpha build.</em></p>
</blockquote>

<p>Not only that Adobe has already made this beta public, so they should just accept how users react. It also this a little condescending to assume that the user doesn’t know anything about software development, especially something as simple as what an alpha build is.</p>

<p>To go back to the example that Adobe used to defend their choice, the beta disclaimer in Windows is actually an option in Windows that <a href="http://www.windowssquad.com/how-to-display-windows-7-build-version-number-on-desktop/23/">you can turn on even in a non-beta release</a>. Microsoft just chooses to turn it on by default in a beta release and leaves to the users the option to turn it off if they want to.</p>

<p>Beta users are volunteers who come to you as a software maker and give you a great opportunity to take advantage of their time to test out your software and find out bugs and usage scenarios about it that you wouldn’t imagine. Their reward shouldn’t be that you treat them like crap and tell them that they’re wrong and don’t understand how software works. Their reward should be to make their lives easier, to welcome their feedback and suggestions, to treat them like they’re part of the team.</p>

<p>Mozilla gives beta users access to a <a href="http://input.mozilla.com/en-US/">feedback dashboard</a>. They give them a button that is very simple to use with happy face and sad face and you only need to write a single sentence to say what’s on your mind. You don’t have to register, you don’t have to answer a survey or pick from a list. No, it’s a minimum barrier of entry, because they want you feedback and they’ll figure out how to make most of it.</p>

<p>A public beta is not just publishing an early release of your upcoming version. It’s a process of including a new member in your development team; the public. Like any other member that is joining your team, if you don’t have a job description for them, or have tools ready for them to use, it’s all a waste of time and money. And what do Adobe do to this team member who is providing feedback, they decline their most basic feedback to have an option to turn this thing off. It’s a shame for Adobe to miss up something as simple as this. But others might say “What else is new?”.</p>

<p>I’m uninstalling this early beta of Flash and going back to the version before that.</p>

  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page5">Older</a>
  
  
    
      <a class="pagination-item newer" href="/page3">Newer</a>
    
  
</div>
    </div>

  </body>
</html>
